# 表单组件逻辑引擎功能文档

## 📋 概述

本文档详细说明了表单设计器中各组件的逻辑引擎集成状态，包括联动功能和可见性控制能力。

## 🎯 逻辑引擎功能类型

### 1. 联动逻辑（Linkage Logic）
- **功能**：当某个组件的值满足条件时，自动设置另一个组件的值
- **语法**：当 [组件A] 的值 [条件] [值] 时，设置 [组件B] 的值为 [目标值]
- **条件类型**：等于、大于、小于、不等于、包含、不包含

### 2. 可见性逻辑（Visibility Logic）
- **功能**：当某个组件的值满足条件时，控制另一个组件的显示状态
- **语法**：当 [组件A] 的值 [条件] [值] 时，设置 [组件B] [显示/隐藏/管理员可见]
- **状态类型**：显示、隐藏、管理员可见

## 🔧 组件功能分类

### ✅ 完全支持联动的组件（可作为源组件和目标组件）

这些组件具备完整的逻辑引擎集成，支持值变化监听和联动：

#### 1. **文本输入组件 (InputComponent)**
- **组件类型**：`input`
- **联动能力**：✅ 完全支持
- **值类型**：字符串
- **特殊功能**：
  - 支持邮箱、电话、姓名等格式验证
  - 可作为联动的源组件和目标组件
- **使用场景**：
  - 根据下拉选择自动填充相关文本
  - 文本内容变化触发其他组件显示/隐藏

#### 2. **下拉选择组件 (SelectComponent)**
- **组件类型**：`select`
- **联动能力**：✅ 完全支持
- **值类型**：字符串或数组（多选模式）
- **特殊功能**：
  - 智能条件值选择器（在逻辑设置中显示选项列表）
  - 支持单选和多选模式
- **使用场景**：
  - 选择产品类型自动填充价格
  - 选择地区显示相应的配送信息

#### 3. **数字输入组件 (NumberComponent)**
- **组件类型**：`number`
- **联动能力**：✅ 完全支持
- **值类型**：数字
- **特殊功能**：
  - 支持小数位数控制
  - 支持千分位分隔符
  - 支持单位显示
- **使用场景**：
  - 数量 × 单价 = 总价的计算联动
  - 根据数值范围显示不同的提示信息

#### 4. **多行文本组件 (TextareaComponent)**
- **组件类型**：`textarea`
- **联动能力**：✅ 完全支持
- **值类型**：字符串
- **特殊功能**：
  - 支持富文本和普通文本模式
  - 支持字符计数
- **使用场景**：
  - 根据其他组件值自动生成描述文本
  - 文本内容包含关键词时显示相关组件

#### 5. **单选/多选按钮组件 (RadioComponent)**
- **组件类型**：`radio`
- **联动能力**：✅ 完全支持
- **值类型**：字符串或数组（多选模式）
- **特殊功能**：
  - 智能条件值选择器（在逻辑设置中显示选项列表）
  - 支持单选和多选模式
- **使用场景**：
  - 选择付款方式显示相应的支付信息
  - 选择用户类型显示不同的权限设置

#### 6. **日期时间组件 (DateComponent)**
- **组件类型**：`date`
- **联动能力**：✅ 完全支持
- **值类型**：日期字符串
- **特殊功能**：
  - 支持日期和日期时间模式
  - 支持自动获取当前时间
- **使用场景**：
  - 选择开始日期自动设置结束日期
  - 根据日期范围显示不同的价格策略

#### 7. **滑块/评分组件 (SliderComponent)**
- **组件类型**：`slider`
- **联动能力**：✅ 完全支持
- **值类型**：数字
- **特殊功能**：
  - 支持滑块和星级评分两种模式
  - 支持步长和标记点设置
- **使用场景**：
  - 评分变化显示相应的评价文本
  - 滑块值达到阈值时显示警告信息

#### 8. **文件上传组件 (UploadComponent)**
- **组件类型**：`upload`
- **联动能力**：✅ 完全支持
- **值类型**：文件列表数组
- **特殊功能**：
  - 支持按钮和拖拽上传模式
  - 支持文件类型和数量限制
- **使用场景**：
  - 上传文件后自动填充文件名到其他组件
  - 根据上传文件数量显示不同的提示

### 🔍 仅支持可见性控制的组件（只能作为目标组件）

这些组件主要用于展示，不产生用户输入值，但可以被其他组件的逻辑控制显示/隐藏：

#### 9. **预设文本组件 (PresetTextComponent)**
- **组件类型**：`presetText`
- **联动能力**：🟡 仅支持可见性控制
- **功能**：显示预设的文本内容
- **使用场景**：根据其他组件的值显示不同的说明文本

#### 10. **图片展示组件 (ImageComponent)**
- **组件类型**：`image`
- **联动能力**：🟡 仅支持可见性控制
- **功能**：显示单张或多张图片
- **使用场景**：根据产品选择显示相应的产品图片

#### 11. **HTML内容组件 (HtmlComponent)**
- **组件类型**：`html`
- **联动能力**：🟡 仅支持可见性控制
- **功能**：显示自定义HTML内容
- **使用场景**：根据条件显示不同的HTML内容块

#### 12. **倒计时组件 (CountdownComponent)**
- **组件类型**：`countdown`
- **联动能力**：🟡 仅支持可见性控制
- **功能**：显示倒计时
- **使用场景**：在特定条件下显示倒计时提醒

### ❌ 暂不支持逻辑引擎的组件

这些组件由于其特殊性质或复杂性，暂时不支持逻辑引擎功能：

#### 布局组件
- **分组容器 (GroupComponent)** - `group`
- **分栏容器 (ColumnContainerComponent)** - `columnContainer`
- **分割线 (DividerComponent)** - `divider`
- **分页器 (PaginationComponent)** - `pagination`
- **步骤条 (StepsComponent)** - `steps`

#### 项目管理组件
- **项目名称 (ProjectNameComponent)** - `projectName`
- **客户信息 (ClientComponent)** - `client`
- **联系人 (ContactComponent)** - `contact`
- **报价单 (QuotationComponent)** - `quotation`
- **订单明细 (OrderComponent)** - `order`
- **项目说明 (InstructionComponent)** - `instruction`
- **任务列表 (TaskListComponent)** - `taskList`

#### 合同组件
- **合同名称 (ContractNameComponent)** - `contractName`
- **合同方 (ContractPartyComponent)** - `contractParty`
- **我方证照 (OurCertificateComponent)** - `ourCertificate`
- **签名区 (SignatureComponent)** - `signature`

#### 文章组件
- **文章标题 (ArticleTitleComponent)** - `articleTitle`
- **文章内容 (ArticleContentComponent)** - `articleContent`
- **作者 (AuthorComponent)** - `author`
- **文章摘要 (ArticleSummaryComponent)** - `articleSummary`
- **文章分类 (ArticleCategoryComponent)** - `articleCategory`
- **文章标签 (ArticleTagsComponent)** - `articleTags`
- **发布时间 (ArticlePublishTimeComponent)** - `articlePublishTime`
- **封面图片 (ArticleCoverImageComponent)** - `articleCoverImage`
- **SEO设置 (ArticleSeoComponent)** - `articleSeo`

#### 财务组件
- **金额 (AmountComponent)** - `amount`
- **金额大写 (AmountInWordsComponent)** - `amountInWords`
- **总计 (TotalComponent)** - `total`
- **发票类型 (InvoiceTypeComponent)** - `invoiceType`
- **发票信息 (InvoiceInfoComponent)** - `invoiceInfo`
- **付款方式 (PaymentMethodComponent)** - `paymentMethod`

## 🎮 使用方法

### 1. 设置联动逻辑
1. 在表单编辑器中点击"预览"按钮进入预览模式
2. 在属性面板中选择"逻辑设置"选项卡
3. 点击"+ 添加联动性逻辑"
4. 配置条件：选择源组件、条件类型、条件值
5. 配置动作：选择目标组件、设置目标值

### 2. 设置可见性逻辑
1. 同样在"逻辑设置"选项卡中
2. 点击"+ 添加可见性逻辑"
3. 配置条件：选择源组件、条件类型、条件值
4. 配置动作：选择目标组件、设置可见性状态

### 3. 测试逻辑
1. 在预览模式下与组件交互
2. 观察联动效果是否符合预期
3. 检查控制台日志了解规则执行情况

## 🔮 未来规划

### 短期计划
- 为文章组件添加逻辑引擎支持
- 为财务组件添加逻辑引擎支持
- 优化复杂组件的联动性能

### 长期计划
- 支持更复杂的条件表达式
- 添加数学运算支持
- 支持跨表单的组件联动
- 添加联动规则的可视化调试工具

## 📝 注意事项

1. **性能考虑**：避免创建循环联动（A→B→A）
2. **值类型匹配**：确保源组件的值类型与条件值类型匹配
3. **预览模式**：逻辑规则只在预览模式下生效
4. **调试信息**：可通过浏览器控制台查看详细的规则执行日志

## 🆘 常见问题

**Q: 为什么我的联动规则没有生效？**
A: 请检查：
- 是否在预览模式下测试
- 条件值是否与实际组件值匹配（特别注意下拉选择的value vs label）
- 源组件和目标组件是否都支持联动功能

**Q: 如何实现复杂的计算联动？**
A: 目前支持简单的值传递联动，复杂计算功能在未来版本中会添加。

**Q: 可以同时设置多个联动规则吗？**
A: 可以，所有规则会按顺序执行，后执行的规则会覆盖先执行的规则结果。

---

*文档版本：v1.0*  
*最后更新：2024年12月*
